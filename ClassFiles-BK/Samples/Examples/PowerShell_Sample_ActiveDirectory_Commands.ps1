# Sample Active Directory Queries and 'doing' actions


Get-ADDomain -Identity:"NHMNBK.COM" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -IncludeDeletedObjects:$false -LDAPFilter:"(objectClass=*)" -Properties:uPNSuffixes -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"CN=Partitions,CN=Configuration,DC=NHMNBK,DC=COM" -SearchScope:"Base" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -IncludeDeletedObjects:$false -LDAPFilter:"(objectClass=*)" -Properties:uPNSuffixes -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"OU=IT,DC=NHMNBK,DC=COM" -SearchScope:"Base" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADAuthenticationPolicy -Filter:"*" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADAuthenticationPolicySilo -Filter:"*" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(&(objectCategory=attributeSchema)(rangeUpper=*)(|(ldapDisplayName=mail)(ldapDisplayName=servicePrincipalName)(ldapDisplayName=objectClass)(ldapDisplayName=msDS-PasswordHistoryLength)(ldapDisplayName=department)(ldapDisplayName=groupType)(ldapDisplayName=logonCount)(ldapDisplayName=canonicalName)(ldapDisplayName=otherMobile)(ldapDisplayName=userPrincipalName)(ldapDisplayName=member)(ldapDisplayName=profilePath)(ldapDisplayName=msDS-PhoneticLastName)(ldapDisplayName=url)(ldapDisplayName=homeDirectory)(ldapDisplayName=lastKnownParent)(ldapDisplayName=logonHours)(ldapDisplayName=sAMAccountName)(ldapDisplayName=location)(ldapDisplayName=pwdLastSet)(ldapDisplayName=lastLogonTimestamp)(ldapDisplayName=directReports)(ldapDisplayName=msDS-User-Account-Control-Computed)(ldapDisplayName=street)(ldapDisplayName=userAccountControl)(ldapDisplayName=uSNChanged)(ldapDisplayName=CannotChangePassword)(ldapDisplayName=l)(ldapDisplayName=msDS-PasswordComplexityEnabled)(ldapDisplayName=scriptPath)(ldapDisplayName=givenName)(ldapDisplayName=lockoutTime)(ldapDisplayName=msDS-MaximumPasswordAge)(ldapDisplayName=msDS-MinimumPasswordAge)(ldapDisplayName=otherPager)(ldapDisplayName=msDS-PhoneticCompanyName)(ldapDisplayName=primaryGroupID)(ldapDisplayName=msDS-MinimumPasswordLength)(ldapDisplayName=badPwdCount)(ldapDisplayName=description)(ldapDisplayName=msDS-LockoutDuration)(ldapDisplayName=physicalDeliveryOfficeName)(ldapDisplayName=displayName)(ldapDisplayName=msDS-AllowedToDelegateTo)(ldapDisplayName=ntSecurityDescriptor)(ldapDisplayName=wWWHomePage)(ldapDisplayName=objectSid)(ldapDisplayName=postalCode)(ldapDisplayName=systemFlags)(ldapDisplayName=otherIpPhone)(ldapDisplayName=homeDrive)(ldapDisplayName=manager)(ldapDisplayName=managedBy)(ldapDisplayName=ProtectedFromAccidentalDeletion)(ldapDisplayName=memberOf)(ldapDisplayName=PasswordNeverExpires)(ldapDisplayName=badPasswordTime)(ldapDisplayName=whenCreated)(ldapDisplayName=operatingSystem)(ldapDisplayName=title)(ldapDisplayName=msDS-PasswordSettingsPrecedence)(ldapDisplayName=ipPhone)(ldapDisplayName=pager)(ldapDisplayName=msDS-PasswordReversibleEncryptionEnabled)(ldapDisplayName=msDS-SupportedEncryptionTypes)(ldapDisplayName=sDRightsEffective)(ldapDisplayName=msDS-LockoutObservationWindow)(ldapDisplayName=msDS-PhoneticFirstName)(ldapDisplayName=uSNCreated)(ldapDisplayName=otherFacsimileTelephoneNumber)(ldapDisplayName=streetAddress)(ldapDisplayName=st)(ldapDisplayName=ou)(ldapDisplayName=msDS-PhoneticDisplayName)(ldapDisplayName=sn)(ldapDisplayName=userWorkstations)(ldapDisplayName=cn)(ldapDisplayName=lastLogoff)(ldapDisplayName=msDS-LockoutThreshold)(ldapDisplayName=otherTelephone)(ldapDisplayName=mobile)(ldapDisplayName=otherHomePhone)(ldapDisplayName=isDeleted)(ldapDisplayName=sIDHistory)(ldapDisplayName=telephoneNumber)(ldapDisplayName=msDS-PSOAppliesTo)(ldapDisplayName=msDS-PhoneticDepartment)(ldapDisplayName=company)(ldapDisplayName=operatingSystemVersion)(ldapDisplayName=allowedAttributesEffective)(ldapDisplayName=info)(ldapDisplayName=homePhone)(ldapDisplayName=name)(ldapDisplayName=employeeID)(ldapDisplayName=dNSHostName)(ldapDisplayName=c)(ldapDisplayName=facsimileTelephoneNumber)(ldapDisplayName=initials)(ldapDisplayName=accountExpires)(ldapDisplayName=operatingSystemServicePack)(ldapDisplayName=whenChanged)(ldapDisplayName=PasswordExpired)))" -Properties:lDAPDisplayName,rangeUpper -ResultPageSize:"100" -ResultSetSize:$null -SearchBase:"CN=Schema,CN=Configuration,DC=NHMNBK,DC=COM" -SearchScope:"OneLevel" -Server:"Win2019-DC1.NHMNBK.COM"
New-ADUser -Company:"f" -Department:"sdf" -Description:"asdfadsfasdf" -DisplayName:"Frank Jones" -EmailAddress:"sdf" -Fax:"55" -GivenName:"Frank" -HomePage:"sdf" -HomePhone:"555" -MobilePhone:"55" -Name:"Frank Jones" -Office:"asdf" -OfficePhone:"555" -Path:"OU=IT,DC=NHMNBK,DC=COM" -SamAccountName:"fjones" -Server:"Win2019-DC1.NHMNBK.COM" -Surname:"Jones" -Type:"user" -UserPrincipalName:"fjones@NHMNBK.COM"
# Set-ADAccountPassword -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -NewPassword:"System.Security.SecureString" -Reset:$true -Server:"Win2019-DC1.NHMNBK.COM"
Enable-ADAccount -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -IncludeDeletedObjects:$false -Properties:primaryGroupID,memberOf,objectSid -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADGroup -Identity:"S-1-5-21-2731716323-1619009323-424888470-513" -Server:"Win2019-DC1.NHMNBK.COM"
Add-ADPrincipalGroupMembership -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -MemberOf:"CN=IT,OU=IT,DC=NHMNBK,DC=COM" -Server:"Win2019-DC1.NHMNBK.COM"
Set-ADUser -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -Replace:'manager'="CN=Frank James,OU=Sales,OU=Departments,DC=NHMNBK,DC=COM" -Server:"Win2019-DC1.NHMNBK.COM"
Set-ADAccountControl -AccountNotDelegated:$false -AllowReversiblePasswordEncryption:$false -CannotChangePassword:$false -DoesNotRequirePreAuth:$false -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -PasswordNeverExpires:$false -Server:"Win2019-DC1.NHMNBK.COM" -UseDESKeyOnly:$false
Set-ADUser -ChangePasswordAtLogon:$true -Identity:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -Server:"Win2019-DC1.NHMNBK.COM" -SmartcardLogonRequired:$false
Get-ADObject -LDAPFilter:"(objectClass=*)" -Properties:allowedChildClassesEffective,allowedChildClasses,lastKnownParent,sAMAccountType,systemFlags,userAccountControl,displayName,description,whenChanged,location,managedBy,memberOf,primaryGroupID,objectSid,msDS-User-Account-Control-Computed,sAMAccountName,lastLogonTimestamp,lastLogoff,mail,accountExpires,msDS-PhoneticCompanyName,msDS-PhoneticDepartment,msDS-PhoneticDisplayName,msDS-PhoneticFirstName,msDS-PhoneticLastName,pwdLastSet,operatingSystem,operatingSystemServicePack,operatingSystemVersion,telephoneNumber,physicalDeliveryOfficeName,department,company,manager,dNSHostName,groupType,c,l,employeeID,givenName,sn,title,st,postalCode,managedBy,userPrincipalName,isDeleted,msDS-PasswordSettingsPrecedence -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"CN=Frank Jones,OU=IT,DC=NHMNBK,DC=COM" -SearchScope:"Base" -Server:"Win2019-DC1.NHMNBK.COM"


Get-ADObject -LDAPFilter:"(objectClass=*)"

Get-ADObject -LDAPFilter:"(objectCategory=computer)" 
Get-ADObject -LDAPFilter:"(objectCategory=computer)" -Properties:allowedChildClassesEffective,allowedChildClasses,lastKnownParent,sAMAccountType,systemFlags,userAccountControl,displayName,description,whenChanged,location,managedBy,memberOf,primaryGroupID,objectSid,msDS-User-Account-Control-Computed,sAMAccountName,lastLogonTimestamp,lastLogoff,mail,accountExpires,msDS-PhoneticCompanyName,msDS-PhoneticDepartment,msDS-PhoneticDisplayName,msDS-PhoneticFirstName,msDS-PhoneticLastName,pwdLastSet,operatingSystem,operatingSystemServicePack,operatingSystemVersion,telephoneNumber,physicalDeliveryOfficeName,department,company,manager,dNSHostName,groupType,c,l,employeeID,givenName,sn,title,st,postalCode,managedBy,userPrincipalName,isDeleted,msDS-PasswordSettingsPrecedence -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(objectCategory=computer)" -Properties:* -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(objectCategory=computer)" -Properties:* -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(objectCategory=computer)" -Properties:* -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree"
Get-ADObject -LDAPFilter:"(objectCategory=computer)" -Properties:*



Get-ADComputer -Identity:"CN=WIN10-CL1,CN=Computers,DC=NHMNBK,DC=COM" -Properties:msDS-AssignedAuthNPolicySilo,description,objectClass,displayName,objectSid,location,allowedAttributesEffective,msDS-AssignedAuthNPolicy,operatingSystemServicePack,sDRightsEffective,canonicalName,systemFlags,whenChanged,uSNCreated,operatingSystem,operatingSystemVersion,msDS-AllowedToDelegateTo,sAMAccountName,ntSecurityDescriptor,ProtectedFromAccidentalDeletion,servicePrincipalName,memberOf,managedBy,userAccountControl,whenCreated,primaryGroupID,uSNChanged,dNSHostName -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADComputer -Identity:"CN=WIN10-CL1,CN=Computers,DC=NHMNBK,DC=COM"

Get-ADObject -LDAPFilter:"(anr=bob)" -Properties:allowedChildClassesEffective,allowedChildClasses,lastKnownParent,sAMAccountType,systemFlags,userAccountControl,displayName,description,whenChanged,location,managedBy,memberOf,primaryGroupID,objectSid,msDS-User-Account-Control-Computed,sAMAccountName,lastLogonTimestamp,lastLogoff,mail,accountExpires,msDS-PhoneticCompanyName,msDS-PhoneticDepartment,msDS-PhoneticDisplayName,msDS-PhoneticFirstName,msDS-PhoneticLastName,pwdLastSet,operatingSystem,operatingSystemServicePack,operatingSystemVersion,telephoneNumber,physicalDeliveryOfficeName,department,company,manager,dNSHostName,groupType,c,l,employeeID,givenName,sn,title,st,postalCode,managedBy,userPrincipalName,isDeleted,msDS-PasswordSettingsPrecedence -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"


Get-ADObject -LDAPFilter:"(objectCategory=computer)" 
Get-ADObject -LDAPFilter:"(objectCategory=user)" 
Get-ADObject -LDAPFilter:"(objectCategory=group)" 
Get-ADObject -LDAPFilter:"(objectCategory=organizationalUnit)" 
Get-ADObject -LDAPFilter:"(objectCategory=Site)" 

Get-ADObject -LDAPFilter:"(anr=win)" 
Get-ADObject -LDAPFilter:"(anr=lon-)" 

Get-ADObject -LDAPFilter:"(&(objectCategory=person)(objectClass=user))"
Get-ADObject -LDAPFilter:"(&(objectCategory=person)(objectClass=user)(!objectClass=inetOrgPerson))" -Properties:allowedChildClassesEffective,allowedChildClasses,lastKnownParent,sAMAccountType,systemFlags,userAccountControl,displayName,description,whenChanged,location,managedBy,memberOf,primaryGroupID,objectSid,msDS-User-Account-Control-Computed,sAMAccountName,lastLogonTimestamp,lastLogoff,mail,accountExpires,msDS-PhoneticCompanyName,msDS-PhoneticDepartment,msDS-PhoneticDisplayName,msDS-PhoneticFirstName,msDS-PhoneticLastName,pwdLastSet,operatingSystem,operatingSystemServicePack,operatingSystemVersion,telephoneNumber,physicalDeliveryOfficeName,department,company,manager,dNSHostName,groupType,c,l,employeeID,givenName,sn,title,st,postalCode,managedBy,userPrincipalName,isDeleted,msDS-PasswordSettingsPrecedence -ResultPageSize:"100" -ResultSetSize:"20201" -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(&(objectCategory=person)(objectClass=user)(!objectClass=inetOrgPerson))" -SearchBase:"DC=NHMNBK,DC=COM" -SearchScope:"Subtree" -Server:"Win2019-DC1.NHMNBK.COM"
Get-ADObject -LDAPFilter:"(&(objectCategory=person)(objectClass=user)(!objectClass=inetOrgPerson))"